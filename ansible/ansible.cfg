# Ansible Configuration for Talos Infrastructure Management
#
# This configuration file sets defaults for Ansible playbooks
# managing Talos Linux on Proxmox

[defaults]
# Inventory
inventory = ./inventory/hosts.yml

# Connection settings
host_key_checking = False
timeout = 30
gather_facts = True
fact_caching = jsonfile
fact_caching_connection = /tmp/ansible_facts
fact_caching_timeout = 3600

# Output
stdout_callback = default
result_format = yaml
bin_ansible_callbacks = True
display_skipped_hosts = False
display_ok_hosts = True

# Roles
roles_path = ./roles:~/.ansible/roles:/usr/share/ansible/roles

# Collections
collections_paths = ./collections:~/.ansible/collections:/usr/share/ansible/collections

# Retry files
retry_files_enabled = False

# SSH settings (for Proxmox host and traditional VMs, not Talos)
[ssh_connection]
ssh_args = -o ControlMaster=auto -o ControlPersist=60s -o StrictHostKeyChecking=no
pipelining = True
control_path = /tmp/ansible-ssh-%%h-%%p-%%r

# Privilege escalation
[privilege_escalation]
become = True
become_method = sudo
become_user = root
become_ask_pass = False

# Galaxy
[galaxy]
server_list = release_galaxy

[galaxy_server.release_galaxy]
url = https://galaxy.ansible.com/

# Notes:
# - Talos nodes don't use SSH - they use talosctl API
# - SSH is only used for Proxmox host and traditional VMs
# - For Talos operations, use talosctl commands via shell module
# - SOPS-encrypted variables can be loaded with community.sops collection
