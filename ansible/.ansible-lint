# Ansible Lint Configuration
# https://ansible.readthedocs.io/projects/lint/configuring/
#
# Updated: 2026-01-20

# Use production profile for stricter checks
profile: production

# Don't make linting errors fatal during development
strict: false

# Offline mode for faster linting (no network lookups)
offline: false

# Skip specific rules for valid use cases
skip_list:
  # OK for Packer builds (single machine)
  - run-once
  # Commands in cleanup tasks are expected to change
  - no-changed-when
  # Shell commands for cleanup are appropriate
  - command-instead-of-shell
  # AUR packages require cloning latest version
  - latest[git]
  # Some inline tasks with when: changed are appropriate (API token display, hostname reboot)
  - no-handler
  # GPU mapping config file has specific format requirements (tab-indented, single line)
  - yaml[line-length]

# Exclude paths from linting
exclude_paths:
  # Variable files don't need linting
  - roles/baseline/vars/
  - group_vars/
  - host_vars/
  # Templates are Jinja2, not YAML
  - templates/
  # Test files
  - tests/
  # Generated files
  - .cache/

# Warn-only rules (don't fail on these)
warn_list:
  # Package name differences across distros
  - package-latest
  # Complex conditionals are sometimes necessary
  - no-jinja-when

# Enable rules that are off by default
enable_list:
  # Check for deprecated syntax
  - args
  # Check YAML formatting
  - yaml

# File patterns to check
kinds:
  - yaml: "**/playbooks/*.yml"
  - yaml: "**/tasks/*.yml"
  - yaml: "**/handlers/*.yml"
  - yaml: "**/roles/**/tasks/*.yml"
  - yaml: "**/roles/**/handlers/*.yml"
  - yaml: "**/packer-provisioning/*.yml"
