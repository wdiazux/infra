---
# Quick Timezone Configuration Test
#
# This playbook applies ONLY timezone configuration to VMs
# Run with: ansible-playbook playbooks/test-timezone.yml

- name: Test Timezone Configuration
  hosts: all
  become: yes
  gather_facts: yes

  vars:
    # Override default timezone for this test
    baseline_timezone: "America/New_York"

  tasks:
    - name: Set timezone (Linux)
      community.general.timezone:
        name: "{{ baseline_timezone }}"
      when: ansible_os_family != "Windows"

    - name: Set timezone (Windows)
      community.windows.win_timezone:
        timezone: "Eastern Standard Time"  # Windows timezone name
      when: ansible_os_family == "Windows"

    - name: Display current timezone (Linux)
      ansible.builtin.command: timedatectl
      register: timezone_info
      changed_when: false
      when: ansible_os_family != "Windows"

    - name: Display timezone info (Linux)
      ansible.builtin.debug:
        var: timezone_info.stdout_lines
      when: ansible_os_family != "Windows"

    - name: Display current timezone (Windows)
      ansible.windows.win_shell: Get-TimeZone
      register: timezone_info_win
      when: ansible_os_family == "Windows"

    - name: Display timezone info (Windows)
      ansible.builtin.debug:
        var: timezone_info_win.stdout_lines
      when: ansible_os_family == "Windows"
