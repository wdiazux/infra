# Ansible Requirements for Infrastructure Automation
#
# UPDATED: December 2025
# Minimum Ansible Version: ansible-core 2.17.0+ (required by community.general v12+)
# Recommended: ansible-core 2.20.0+ or latest stable
#
# Installation:
#   pip install ansible --upgrade
#   ansible-galaxy collection install -r requirements.yml
#
# Breaking Changes Warning:
#   - community.general v12 requires ansible-core 2.17+
#   - kubernetes.core v6 requires ansible-core 2.16+, Python 3.9+
#   - Review migration guides before upgrading production systems

---
# Ansible Collections
collections:
  # SOPS for encrypted secrets
  # UPDATED: v1.x → v2.2.7 (Dec 2025)
  # Breaking changes: Review migration guide at https://github.com/ansible-collections/community.sops
  - name: community.sops
    version: ">=2.2.7"
    source: https://galaxy.ansible.com

  # General utilities (Linux VMs)
  # UPDATED: v7.x → v12.0.1 (Dec 2025)
  # Breaking changes: Requires ansible-core 2.17+. Review changelog for deprecations
  - name: community.general
    version: ">=12.0.1"
    source: https://galaxy.ansible.com

  # POSIX utilities (mount, sysctl, etc.)
  # UPDATED: v1.5.0 → v2.1.0 (Dec 2025)
  - name: ansible.posix
    version: ">=2.1.0"
    source: https://galaxy.ansible.com

  # Windows management
  # UPDATED: v2.x → v3.2.0 (Dec 2025)
  # Breaking changes: Requires ansible-core 2.16+
  - name: ansible.windows
    version: ">=3.2.0"
    source: https://galaxy.ansible.com

  # UPDATED: v2.x → v3.0.1 (Dec 2025)
  # Breaking changes: Requires ansible-core 2.16+
  - name: community.windows
    version: ">=3.0.1"
    source: https://galaxy.ansible.com

  # Kubernetes management (kubectl and Helm from Ansible)
  # UPDATED: v2.x → v6.2.0 (Dec 2025)
  # Breaking changes: Requires ansible-core 2.16+, Python 3.9+, kubernetes lib 24.2.0+
  - name: kubernetes.core
    version: ">=6.2.0"
    source: https://galaxy.ansible.com

# Notes:
# - community.sops: Required for decrypting SOPS-encrypted secrets
# - community.general: Essential utilities (timezone, locale, pacman, ufw, etc.)
# - ansible.posix: Mount points, sysctl, other POSIX utilities
# - ansible.windows: Core Windows modules (win_feature, win_service, etc.)
# - community.windows: Additional Windows modules (win_firewall, win_timezone, etc.)
# - kubernetes.core: For kubectl and Helm operations on Kubernetes clusters
#
# NOTE: Talos Linux is NOT managed via Ansible - use talosctl and Terraform.
# kubernetes.core is for deploying apps to Kubernetes, not managing Talos itself.
#
# Installation:
# 1. Install collections: ansible-galaxy collection install -r requirements.yml
# 2. For Windows: Install pywinrm on control node: pip install pywinrm
# 3. For SOPS: Ensure Age is installed and SOPS_AGE_KEY_FILE is set
