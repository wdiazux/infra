# Grafana Dashboards ConfigMap
#
# Pre-built dashboards for Kubernetes monitoring.
apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-dashboards
  namespace: monitoring
  labels:
    app.kubernetes.io/name: grafana
    app.kubernetes.io/part-of: monitoring
data:
  kubernetes-cluster.json: |
    {
      "annotations": {
        "list": []
      },
      "editable": true,
      "fiscalYearStartMonth": 0,
      "graphTooltip": 0,
      "id": null,
      "links": [],
      "liveNow": false,
      "panels": [
        {
          "gridPos": {"h": 4, "w": 6, "x": 0, "y": 0},
          "id": 1,
          "options": {"colorMode": "value", "graphMode": "none", "justifyMode": "auto", "orientation": "auto", "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false}, "textMode": "auto"},
          "pluginVersion": "10.0.0",
          "targets": [{"datasource": {"type": "prometheus", "uid": "victoriametrics"}, "expr": "count(kube_node_info)", "refId": "A"}],
          "title": "Nodes",
          "type": "stat"
        },
        {
          "gridPos": {"h": 4, "w": 6, "x": 6, "y": 0},
          "id": 2,
          "options": {"colorMode": "value", "graphMode": "none", "justifyMode": "auto", "orientation": "auto", "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false}, "textMode": "auto"},
          "pluginVersion": "10.0.0",
          "targets": [{"datasource": {"type": "prometheus", "uid": "victoriametrics"}, "expr": "count(kube_pod_info)", "refId": "A"}],
          "title": "Pods",
          "type": "stat"
        },
        {
          "gridPos": {"h": 4, "w": 6, "x": 12, "y": 0},
          "id": 3,
          "options": {"colorMode": "value", "graphMode": "none", "justifyMode": "auto", "orientation": "auto", "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false}, "textMode": "auto"},
          "pluginVersion": "10.0.0",
          "targets": [{"datasource": {"type": "prometheus", "uid": "victoriametrics"}, "expr": "count(kube_deployment_labels)", "refId": "A"}],
          "title": "Deployments",
          "type": "stat"
        },
        {
          "gridPos": {"h": 4, "w": 6, "x": 18, "y": 0},
          "id": 4,
          "options": {"colorMode": "value", "graphMode": "none", "justifyMode": "auto", "orientation": "auto", "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false}, "textMode": "auto"},
          "pluginVersion": "10.0.0",
          "targets": [{"datasource": {"type": "prometheus", "uid": "victoriametrics"}, "expr": "count(kube_service_info)", "refId": "A"}],
          "title": "Services",
          "type": "stat"
        },
        {
          "gridPos": {"h": 8, "w": 12, "x": 0, "y": 4},
          "id": 5,
          "options": {},
          "targets": [{"datasource": {"type": "prometheus", "uid": "victoriametrics"}, "expr": "sum(rate(container_cpu_usage_seconds_total{container!=\"\"}[5m])) by (namespace)", "legendFormat": "{{namespace}}", "refId": "A"}],
          "title": "CPU Usage by Namespace",
          "type": "timeseries"
        },
        {
          "gridPos": {"h": 8, "w": 12, "x": 12, "y": 4},
          "id": 6,
          "options": {},
          "targets": [{"datasource": {"type": "prometheus", "uid": "victoriametrics"}, "expr": "sum(container_memory_working_set_bytes{container!=\"\"}) by (namespace) / 1024 / 1024 / 1024", "legendFormat": "{{namespace}}", "refId": "A"}],
          "title": "Memory Usage by Namespace (GB)",
          "type": "timeseries"
        },
        {
          "gridPos": {"h": 8, "w": 12, "x": 0, "y": 12},
          "id": 7,
          "options": {},
          "targets": [{"datasource": {"type": "prometheus", "uid": "victoriametrics"}, "expr": "sum(rate(container_network_receive_bytes_total[5m])) by (namespace) / 1024 / 1024", "legendFormat": "{{namespace}} RX", "refId": "A"}, {"datasource": {"type": "prometheus", "uid": "victoriametrics"}, "expr": "sum(rate(container_network_transmit_bytes_total[5m])) by (namespace) / 1024 / 1024", "legendFormat": "{{namespace}} TX", "refId": "B"}],
          "title": "Network I/O by Namespace (MB/s)",
          "type": "timeseries"
        },
        {
          "gridPos": {"h": 8, "w": 12, "x": 12, "y": 12},
          "id": 8,
          "options": {},
          "targets": [{"datasource": {"type": "prometheus", "uid": "victoriametrics"}, "expr": "sum(kube_pod_container_status_running) by (namespace)", "legendFormat": "{{namespace}}", "refId": "A"}],
          "title": "Running Containers by Namespace",
          "type": "timeseries"
        }
      ],
      "refresh": "30s",
      "schemaVersion": 38,
      "style": "dark",
      "tags": ["kubernetes"],
      "templating": {"list": []},
      "time": {"from": "now-1h", "to": "now"},
      "timepicker": {},
      "timezone": "",
      "title": "Kubernetes Cluster Overview",
      "uid": "k8s-cluster-overview",
      "version": 1,
      "weekStart": ""
    }
  node-exporter.json: |
    {
      "annotations": {"list": []},
      "editable": true,
      "fiscalYearStartMonth": 0,
      "graphTooltip": 0,
      "id": null,
      "links": [],
      "liveNow": false,
      "panels": [
        {
          "gridPos": {"h": 4, "w": 6, "x": 0, "y": 0},
          "id": 1,
          "options": {"colorMode": "value", "graphMode": "area", "justifyMode": "auto", "orientation": "auto", "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false}, "textMode": "auto"},
          "targets": [{"datasource": {"type": "prometheus", "uid": "victoriametrics"}, "expr": "100 - (avg(rate(node_cpu_seconds_total{mode=\"idle\"}[5m])) * 100)", "refId": "A"}],
          "title": "CPU Usage %",
          "type": "stat"
        },
        {
          "gridPos": {"h": 4, "w": 6, "x": 6, "y": 0},
          "id": 2,
          "options": {"colorMode": "value", "graphMode": "area", "justifyMode": "auto", "orientation": "auto", "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false}, "textMode": "auto"},
          "targets": [{"datasource": {"type": "prometheus", "uid": "victoriametrics"}, "expr": "(1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100", "refId": "A"}],
          "title": "Memory Usage %",
          "type": "stat"
        },
        {
          "gridPos": {"h": 4, "w": 6, "x": 12, "y": 0},
          "id": 3,
          "options": {"colorMode": "value", "graphMode": "area", "justifyMode": "auto", "orientation": "auto", "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false}, "textMode": "auto"},
          "targets": [{"datasource": {"type": "prometheus", "uid": "victoriametrics"}, "expr": "(1 - (node_filesystem_avail_bytes{mountpoint=\"/\"} / node_filesystem_size_bytes{mountpoint=\"/\"})) * 100", "refId": "A"}],
          "title": "Disk Usage %",
          "type": "stat"
        },
        {
          "gridPos": {"h": 4, "w": 6, "x": 18, "y": 0},
          "id": 4,
          "options": {"colorMode": "value", "graphMode": "none", "justifyMode": "auto", "orientation": "auto", "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false}, "textMode": "auto"},
          "targets": [{"datasource": {"type": "prometheus", "uid": "victoriametrics"}, "expr": "node_time_seconds - node_boot_time_seconds", "refId": "A"}],
          "title": "Uptime (seconds)",
          "type": "stat"
        },
        {
          "gridPos": {"h": 8, "w": 12, "x": 0, "y": 4},
          "id": 5,
          "targets": [{"datasource": {"type": "prometheus", "uid": "victoriametrics"}, "expr": "100 - (avg(rate(node_cpu_seconds_total{mode=\"idle\"}[5m])) * 100)", "legendFormat": "CPU Usage", "refId": "A"}],
          "title": "CPU Usage Over Time",
          "type": "timeseries"
        },
        {
          "gridPos": {"h": 8, "w": 12, "x": 12, "y": 4},
          "id": 6,
          "targets": [{"datasource": {"type": "prometheus", "uid": "victoriametrics"}, "expr": "node_memory_MemTotal_bytes / 1024 / 1024 / 1024", "legendFormat": "Total", "refId": "A"}, {"datasource": {"type": "prometheus", "uid": "victoriametrics"}, "expr": "(node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes) / 1024 / 1024 / 1024", "legendFormat": "Used", "refId": "B"}],
          "title": "Memory Usage (GB)",
          "type": "timeseries"
        }
      ],
      "refresh": "30s",
      "schemaVersion": 38,
      "style": "dark",
      "tags": ["node"],
      "templating": {"list": []},
      "time": {"from": "now-1h", "to": "now"},
      "timepicker": {},
      "timezone": "",
      "title": "Node Overview",
      "uid": "node-overview",
      "version": 1,
      "weekStart": ""
    }
